---
title: npm 패키지 생성에서 배포까지
date: '2023-03-02'
thumb: '/images/thumb/npm.jpg'
tech: [0, 16]
series: []
toc:
  {
    0: { title: 'npm? (Node Package Manager)' },
    1: { title: 'Package.json?', item: ['📍 package.json이란?', '📍 생성하기 (npm 초기화)', '📍 필드 구성'] },
    2: { title: 'npm package 배포' },
    3: { title: '수정 후 재배포' },
  }
---

# npm? Node Package Manager {#0}

---

[공식 문서](https://docs.npmjs.com/about-npm)에는 npm에 대해 아래처럼 설명한다.

> _npm is the world's largest software registry. Open source developers from every continent use npm to share and borrow packages, and many organizations use npm to manage private development as well._

즉, npm은 node 모듈을 패키지로 만들어 관리하고 공유할 수 있도록 하는 오픈소스 레지스트리다.

# Package.json? {#1}

---

## 📍 package.json이란? {#1-0}

package.json 또한 [공식 문서](https://docs.npmjs.com/creating-a-package-json-file)를 먼저 살펴보았다.

> _You can add a `package.json` file to your package to make it easy for others to manage and install. Packages published to the registry must contain a `package.json` file._
>
> A `package.json` file:
>
> - lists the packages your project depends on
> - specifies versions of a package that your project can use using [semantic versioning rules](https://docs.npmjs.com/about-semantic-versioning)
> - makes your build reproducible, and therefore easier to share with other developers

요약하면, package.json은 패키지 이름, 버전, 의존성 등을 포함하여, 배포된 패키지를 다른 사람이 쉽게 관리 및 설치할 수 있도록 해주는 문서다.

## 📍 생성하기 (npm 초기화) {#1-1}

`npm init`으로 초기 설정을 진행한다. package.json 생성 후 수정이 가능하니 일단 `npm init -y`로 편하게 생성해도 된다.

- `npm init -y`로 초기화했을 때의 package.json
  ```jsx
  {
    "name": "package-name",
    "version": "1.0.0",
    "description": "",
    "main": "index.js",
    "scripts": {
      "test": "echo \"Error: no test specified\" && exit 1"
    },
    "keywords": [],
    "author": "",
    "license": "ISC"
  }
  ```

## 📍 필드 구성 {#1-2}

- name(필수): 패키지 이름을 지정한다. 소문자, 한 단어여야 하고 하이픈과 언더스코어를 포함할 수 있다.
- version(필수): 기본 `1.0.0`이며, [semantic versioning guidelines](https://docs.npmjs.com/about-semantic-versioning)을 따라 x.x.x 형식으로 작성해야 한다.
- author: `이름 <이메일> (웹사이트)`형식으로, 이메일과 웹사이트는 선택적으로 작성한다.
- description: 패키지에 대한 설명을 작성한다. npm에 검색될 때 표시된다.
- main: 패키지의 진입점(entry point)으로, 기본은 `index.js`로 설정된다.
- scripts: 패키지의 생명주기에서 실행될 명령을 설정한다. key에는 생명주기의 이벤트, value에는 실행 할 명령을 기록한다.
- keywords: 사람들이 패키지를 찾는 데 도움이 될 문자열 배열을 작성한다.
- license: 기본은 ISC로, 사람들이 패키지 사용이 허용된 방식과 제한 사항을 알 수 있도록 한다.
- repository: 코드가 저장된 github 저장소를 지정한다.
  ```jsx
  "repository": {
    "type": "git",
    "url": "https://github.com/~"
  },
  ```
- homepage: 프로젝트 홈페이지의 url을 적어준다.
- 필드의 더 자세한 내용은 [공식 문서](https://docs.npmjs.com/cli/v7/configuring-npm/package-json)를 확인하자!

# npm package 배포 {#2}

---

1. `npm login`: 로그인

   명령어를 실행하면 순서대로 username, password, email을 묻는다.
   다 제대로 입력하면 *“Please check your email for a one-time password (OTP)”*이란 문구가 뜨고 메일에서 OTP 코드를 확인하고 입력한다.

2. `npm whoami`: 제대로 로그인이 됐는지 확인
3. `npm publish`: npm에 배포

   이 때 발생할 수 있는 에러가 있다.

   - _403 Forbidden - PUT https://registry.npmjs.org/package-name - You do not have permission to publish "package-name". Are you logged in as the correct user?_
     : 권한이 없다는 에러로, 내가 지정한 패키지 이름이 다른 유저에 의해 이미 존재하는 경우 발생할 수 있다. 이름을 변경해주거나 이름 앞에 원하는 스코프를 추가해 준다. `@scope/package-name`
   - _402 Payment Required - PUT http://registry.npmjs.org/@scope/package-name - You must sign up for private packages_
     : npm은 기본 public으로, private package는 유료서비스다. 위 에러는 private package로 배포하려 해서 발생하는 에러다. `npm publish --access=public`로 다시 시도해보자.

4. 마지막으로 [npm](https://www.npmjs.com/) 홈페이지의 packages로 가서 배포가 잘 되었는지 확인한다!

# 수정 후 재배포 {#3}

---

1. 수정 후 버전을 변경해야 재배포가 가능하다.
   - package.json 파일에서 직접 수정해준다.
   - 또는, `npm version [major 또는 minor 또는 patch]` 명령어를 실행한다. 버전은 `major.minor.patch`로 표기하고, 적절한 명령어를 선택한다.
2. 처음과 동일하게 `npm publish` 명령어를 사용하여 배포한다.
